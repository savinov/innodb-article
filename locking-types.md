### Блокировки

**Режимы работы блокировок**

InnoDB реализует блокировки строк в двух режимах: чтения ([shared (s) lock](http://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_shared_lock)) и записи ([exclusive (x) lock](http://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_exclusive_lock)).

Блокировка в режиме чтения позволяет транзакции, получившей эту блокировку читать строку. Блокировка в режиме записи позволяет транзакции не только читать, но и обновлять и удалять строку.

Если транзакция `T1` обладает блокировкой чтения на строку `r`, то запрос от второй транзакции `T2` на блокировку той же строки `r` обрабатывается следующим образом:

1. запрос на блокировку чтения может быть выдан сразу же, т.е. в результате обе транзакции `T1` и `T2` будут обладать блокировками чтения на строку `r`
2. запрос на блокировку записи не может быть выдан до тех пор, пока транзакция `T1` не освободит блокировку чтения на строку `r`

Если транзакция `T1` обладает блокировкой записи на строку `r`, то запрос от второй транзакции `T2` на блокировку любого режима будет приостановлен до тех пор пока транзакция `T1` не освободит блокировку записи.

Для поддежки различной гранулярности блокировки данных, в InnoDB существуют так называемые целевые блокировки ([intention locks]), которые работают не на уровне строк, а на уровне таблиц.
